/*! uppie | (c) silverwind | BSD license */
!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.Uppie=e()}}(function(){"use strict";function e(e,n){var t=new FormData,i=function(e,n,r){var a=[];e.forEach(function(e){a.push(new Promise(function(r){"getFilesAndDirectories"in e?e.getFilesAndDirectories().then(function(n){i(n,e.path,r)}):(e.name&&t.append("file",e,(n+"/"+e.name).replace(/^[\/\\]/,"")),r())}))}),Promise.all(a).then(r)};e.getFilesAndDirectories().then(function(e){new Promise(function(n){i(e,"/",n)}).then(n.bind(null,t))})}function n(e,n){var t=new FormData;[].slice.call(e.files).forEach(function(e){t.append("file",e,e.webkitRelativePath||e.name)}),n(t)}function t(e,n){function t(e,n,i,r){var a=n||e.createReader();a.readEntries(function(n){var o=i?i.concat(n):n;n.length?setTimeout(t.bind(null,e,a,o,r),0):r(o)})}function i(e,n,a){n||(n=e.name),t(e,0,0,function(e){var t=[];e.forEach(function(e){t.push(new Promise(function(t){e.isFile?e.file(function(e){r.append("file",e,n+"/"+e.name),t()},t.bind()):i(e,n+"/"+e.name,t)}))}),Promise.all(t).then(a.bind())})}var r=new FormData,a=[];[].slice.call(e).forEach(function(e){e=e.webkitGetAsEntry(),e&&a.push(new Promise(function(n){e.isFile?e.file(function(e){r.append("file",e,e.name),n()},n.bind()):e.isDirectory&&i(e,null,n)}))}),Promise.all(a).then(n.bind(null,r))}return function(){return function(i,r){if("input"===i.tagName.toLowerCase()&&"file"===i.type)i.addEventListener("change",function(t){"getFilesAndDirectories"in t.target?e(t.target,r.bind(null,t)):t.target.files&&t.target.files.length?n(t.target,r.bind(null,t)):r(t)});else{var a=function(e){e.preventDefault()};i.addEventListener("dragover",a),i.addEventListener("dragenter",a),i.addEventListener("drop",function(i){i.preventDefault();var a=i.dataTransfer;"getFilesAndDirectories"in a?e(a,r.bind(null,i)):a.items&&a.items.length&&"webkitGetAsEntry"in a.items[0]?t(a.items,r.bind(null,i)):a.files?n(a,r.bind(null,i)):r()})}}}});